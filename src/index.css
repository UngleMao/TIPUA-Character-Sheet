/* SHEET LAYOUT */
.sheet-wrap { max-width: 980px; margin: 16px auto; padding: 8px; }
.sheet{
  position: relative;      /* parent for absolute fields */
  width: 100%;
  aspect-ratio: 210 / 320;
  background: #f9f7f2;
  overflow: hidden;
}
.sheet > img{
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  object-fit: fill;       /* try 'contain' if your export has margin */
  pointer-events: none; user-select: none;
}

/* Each overlay field */
.field{
  position: absolute;      /* keep absolute! */
  /* (no translateY now) */
}

/* Title ABOVE the input (container) */
.field-label{
  display: block;          /* forces input below the title */
  line-height: 1.05;
  margin-bottom: 4px;
  font-family: "Noto Sans", Arial, sans-serif; /* or your booklet font */
  font-size: 14px;         /* tweak to match your art */
  letter-spacing: 0.2px;
}

/* Split colour styles */
.label-white { color: #fff; font-weight: 700; }   /* bold white */
.label-black { color: #222; font-weight: 400; }   /* regular dark */

/* Input styles */
.input-underline{
  width: 100%;             /* full width under the title */
  background: transparent;
  border: none;
  border-bottom: 1px solid #0006;
  padding: 2px 4px;
  font: inherit;
  outline: none;
}
.num{ width: 56px; text-align: center; } /* Underlined select to match inputs */
.select-underline {
  width: 100%;
  background: transparent;
  border: none;
  border-bottom: 1px solid #0006;
  padding: 2px 2px 3px 2px; /* a hair more bottom padding looks better */
  font: inherit;
  outline: none;
  appearance: none;        /* cleaner look */
}


/* Debug outline for placement */
.debug-outline .field{ outline: 1px dashed #3aa3ff99; outline-offset: 2px; }

/* Panels / buttons / dice (keep as-is) */
.panel{
  max-width: 980px; margin: 12px auto; padding: 12px;
  border: 1px solid #e2d9cc00; border-radius: 10px; background: #55576600;
}
.btn{ padding: 6px 10px; border:1px solid #d9cfc4; border-radius:8px; background:#fff; cursor:pointer;  }
.btn:active{ transform: translateY(1px); }
.dice{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
.die{ width:36px; height:36px; display:grid; place-items:center; border:1px solid #d9cfc4; border-radius:8px; background:#fff; font-weight:700; font-size:20px; }
/* Bigger titles/inputs for the top identity block */
.field--lg .field-label {
  font-size: clamp(15px, 2vw, 19px);
}
.field--lg .input-underline,
.field--lg .select-underline {
  font-size: clamp(15px, 2vw, 19px);
  padding: 5px 4px;
  border-bottom-width: 3px;
}

/* ===== Mobile tuning (phones) ===== */
@media (max-width: 640px) {
  html, body { margin: 0; padding: 0; }
  .sheet-wrap { max-width: 100vw; margin: 0; padding: 0; }

  .sheet {
    position: relative;
    width: 100vw;
    height: auto;
    aspect-ratio: auto;
    background: #000;
    overflow: visible;
  }
  .sheet > img {
    position: relative;
    inset: auto;
    width: 100%;
    height: auto;
    object-fit: cover;
    display: block;
  }

  /* Compact the identity fields */
  .field--lg .field-label {
    font-size: clamp(11px, 3.2vw, 15px);
    line-height: 1.05;
    margin-bottom: 2px;
  }
  .field--lg .input-underline,
  .field--lg .select-underline {
    font-size: clamp(11px, 3.2vw, 15px);
    padding: 2px 3px 3px 3px;
    border-bottom-width: 1px;
  }

  /* General inputs a touch smaller */
  .input-underline,
  .select-underline {
    font-size: clamp(11px, 3.1vw, 15px);
    padding: 2px 3px 3px 3px;
  }

  /* Super condensed option */
  .field--compact .field-label {
    font-size: clamp(9px, 2.2vw, 11px);
    line-height: 1.0;
    margin-bottom: 0;
    letter-spacing: 0.1px;
  }
  .field--compact .input-underline,
  .field--compact .select-underline {
    font-size: clamp(9px, 2.3vw, 11px);
    padding: 0 2px 1px 2px;
    border-bottom-width: 1px;
  }
}

/* Dice: compact panel */
.dice-compact { display: grid; gap: 8px; align-items: center; max-width: 320px; }
.dice-control { display: flex; gap: 6px; align-items: center; }
.dice-input { width: 64px; text-align: center; border: 1px solid #d9cfc4; border-radius: 8px; padding: 6px; }
@media (max-width: 640px) { .dice-compact { max-width: 280px; } }

/* Roll animation */
@keyframes wobble {
  0% { transform: translateY(0) rotate(0deg); }
  25%{ transform: translateY(-4px) rotate(6deg); }
  50%{ transform: translateY(0) rotate(0deg); }
  75%{ transform: translateY(-4px) rotate(-6deg); }
  100%{ transform: translateY(0) rotate(0deg); }
}
.die.rolling { animation: wobble 0.7s ease-in-out infinite; }

/* Inputs / textareas slightly opaque */
.input-underline,
.select-underline,
.textarea-underline {
  width: 100%;
  border: none;
  border-bottom: 2px solid #000;
  background: rgba(255, 255, 255, 0.5);
  font-size: 14px;
  font-family: inherit;
  outline: none;
  line-height: 1.3;
  padding: 2px 4px;
  border-radius: 4px;
  resize: none;
}

/* Mini labels above small boxes */
.mini-label {
  display: block;
  font-size: 12px;
  font-weight: 600;
  margin: 4px 0 2px;
  color: #333;
  opacity: 0.8;
}

/* Species image fade-in */
.field img { animation: fadeIn 200ms ease-out; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(2px);} to { opacity: 1; transform: translateY(0);} }
@media (max-width: 640px) { .field img { max-height: 22vh; object-fit: contain; } }

/* === SKILLS (two-column layout) === */
/* Titles */
.title .field-label { margin: 0; font-weight: 700; }
.title--skills .field-label { font-size: clamp(14px, 2.2vw, 20px); }
.title--skillsMod .field-label {
  font-size: clamp(8px, 1.2vw, 12px); /* smaller than SKILLS */
  line-height: 1.1;
  text-align: right;
}


/* Left column: dropdowns (rendered inside .skills-column) */
.skills-column .skill-row { margin-bottom: 6px; }
.skills-column select { display: block; width: 100%; }

/* Right column: fixed base + extra input */
.extras-column .extra-row {
  display: flex;
  align-items: center;
  gap: 7px;
  margin-bottom: 6px;
}

.skill-extra {
  width: 50px; text-align: center; padding: 12.8px 2px;
  border: 1px solid #96d5ff; border-radius: 6px; background: #ffffff9d;
   margin-left: auto; /* pushes it to right edge */
}
/* One row for each skill: dropdown + fixed base value */
.skill-row {
  display: flex;
  align-items: center;
  gap: 6px;          /* space between dropdown and base value */
  margin-bottom: 10px;
  width: 400px;

  
}
.skill-row select {
  padding: 9.2px 12px;   /* same as .skill-base */
}


/* If you want the base value centered (recommended for readability) */
.skill-base {
  width: 30px;
  text-align: center;   /* <-- was right; center looks nicer */
  padding: 10px 10px;
  border: 1px solid #90d9f7;
  border-radius: 6px;
  background: #dadada;
  font-weight: 900;
}
.skills-column select {
  display: block;
  width: 100%;
  font-size: 18px;   /* 🔑 tweak this up or down */
}

@media (max-width: 600px) {
  /* Normal Āhei boxes */
  .textarea-underline.ahei {
    height: 40px !important;   /* adjust just for mobile */
    min-height: 0 !important;
    padding-top: 2px;
    padding-bottom: 2px;
    line-height: 1;
  }

  /* Ultimate Āhei boxes */
  .textarea-underline.ultimate {
    height: 37px !important;   /* tweak separately */
    min-height: 0 !important;
    padding-top: 2px;
    padding-bottom: 2px;
    line-height: 1.15;
  }
}
@media (max-width: 640px) {
  .ult-label {
    font-size: 8px !important;   /* or tweak value */
    line-height: 1.1;
    color: #222;                  /* optional: ensure visible */
  }
}
/* default / desktop */
:root {
  --ult-label-size: 12px;
}

/* mobile override */
@media (max-width: 640px) {
  :root {
    --ult-label-size: 12px;
  }
  /* just in case something super-specific tries to override */
  .ult-label { line-height: 1.1; color: #222; }
}
/* Mobile only: smaller user input text in Āhei and Ultimate boxes */
@media (max-width: 640px) {
  .textarea-underline.ahei {
    font-size: 8px;   /* tweak this down */
    line-height: 1.2;
  }
  .textarea-underline.ultimate {
    font-size: 8px;   /* tweak this separately if needed */
    line-height: 1.2;
  }
}
@media (max-width: 640px) {
  .textarea-underline.ahei {
    width: 87.5% !important;
  }
}
/* Mobile only: Ultimate input box tweaks */
@media (max-width: 640px) {
  .textarea-underline.ultimate {
    width: 70% !important;   /* controls width */
    height: 60px;            /* fixed height, tweak as needed */
    font-size: 12px;         /* smaller input font if desired */
    line-height: 1.2;        /* adjust spacing inside */
  }
}
/* Mobile only: scale skills section */
@media (max-width: 640px) {
  .skills-column select {
    font-size: 6px;       /* shrink dropdown text */
    padding: 2px 2px;      /* reduce height */
  }

  .skill-base {
    width: 15px;           /* narrower base box */
    font-size: 8px;       /* smaller number text */
    padding: 2px;          /* smaller height */
  }

  .skill-row {
    gap: 2px;              /* less horizontal spacing */
    
    width: 160%;            /* shrink row width */
  }
}
/* Mobile only: scale down SKILLS title */
@media (max-width: 640px) {
  .title--skills .field-label {
    font-size: clamp(10px, 3vw, 14px); /* smaller text */
    line-height: 1.1;                  /* tighten vertical spacing */
  }
}

/* Mobile only: scale down Āpitihanga modifier boxes */
@media (max-width: 640px) {
  .skill-extra {
    width: 10px;           /* make them narrower */
    font-size: 8px;       /* smaller text */
    padding: 2px 3px;      /* reduce padding for height */
  }
}
/* Base stress title size (desktop default) */
.title--stress .field-label {
  font-size: clamp(18px, 2.0vw, 18px);
  line-height: 1.05;
  margin: 0;
}

/* Mobile: scale them down independently if you want */
@media (max-width: 640px) {
  .title--stress .field-label {
    font-size: clamp(11px, 3.2vw, 14px);
  }

  /* Optional per-title overrides on mobile */
  .title--tinana   .field-label {  font-size: 10px;  }
  .title--hinengaro.field-label {  font-size: 10px;  }
  .title--wairua   .field-label {  font-size: 10px;  }
}
@media (max-width: 640px) {
  .title--hinengaro .field-label {
    font-size: 10px;
  }
}
.title--number .field-label {
  font-size: 1.4rem;   /* adjust size */
  font-weight: 700;
  text-align: left;    /* or center */
}
@media (max-width: 640px) {
  .title--number .field-label {
    font-size: clamp(10px, 3vw, 14px);
  }
}
.stress-row {
  display: grid;
  grid-template-columns: repeat(2, 1fr); /* 2 columns */
  gap: 6px;
}

.stress-box {
  width: 22px;
  height: 22px;
  border: 2px solid #73ccff;
  border-radius: 4px;
  background: #fff;
  cursor: pointer;
}

.stress-box.checked {
  background: #73deff;
}

/* Mobile override */
@media (max-width: 640px) {
  .stress-box {
    width: 13px;   /* adjust as needed */
    height: 13px;  /* adjust as needed */
  }
}

.title--consequences .field-label {
  font-size: clamp(14px, 2vw, 20px); /* adjust to match others */
  line-height: 1.1;
}
@media (max-width: 640px) {
  .title--consequences .field-label {
    font-size: clamp(10px, 3vw, 14px); /* smaller for mobile */
  }
}.roll-btn {
  width: 170px; /* or width: 160px if you want fixed size */
  font-weight: 600; /* optional, to make it stand out */
}
@media (max-width: 600px) {
  .roll-btn {
    min-width: 165px; /* bigger on mobile */
  }
}
/* Mobile: let content (incl. dice) set the height.
   The background image is absolutely positioned and stretched to the
   full height of .sheet via inset:0, so it always covers the taller sheet. */
@media (max-width: 640px) {
  .sheet > img {
    content: url("/Background-mobile.png");
  }
}

@media (max-width: 640px) {
  .panel {
    max-width: 85vw;      /* shrink width to fit smaller screens */
    padding: 2px;         /* reduce padding */
  }

  .dice-compact {
    gap: 4px;             /* less space between controls */
    max-width: 240px;     /* smaller container */
  }

  .dice-input {
    width: 48px;          /* narrower number input */
    padding: 4px;         /* tighter padding */
  }

  .btn {
    padding: 4px 6px;     /* smaller buttons in general */
    font-size: 12px;
  }

  .roll-btn {
    font-size: 14px;      /* shrink roll button text */
    padding: 6px 8px;    /* smaller footprint */
    width: 10px;          /* let it shrink naturally */
  }
}
/* Container the dice will scatter inside */
.dice-scatter {
  position: relative;
  width: 200px;   /* tweak to the space you have */
  height: 120px;  /* tweak to the space you have */
}

/* Where to print the total */
.dice-total {
  position: absolute;
  bottom: 0;
  right: 0;
  font-size: 16px;
}

/* Toss animation (from a small “throw” to final scattered offsets) */
@keyframes toss {
  0% {
    opacity: 0;
    transform: translate(0, -24px) rotate(var(--rz, -25deg)) scale(0.9);
  }
  70% {
    opacity: 1;
  }
  100% {
    opacity: 1;
    transform: translate(var(--dx, 0px), var(--dy, 0px)) rotate(0deg) scale(1);
  }
}

/* Apply this after the roll is settled */
.die.toss-in {
  animation: toss 500ms cubic-bezier(.2,.7,.2,1) both;
}

/* Optional: smaller scatter area on phones */
@media (max-width: 640px) {
  .dice-scatter {
    width: 160px;
    height: 100px;
  }
}
.dice-compact { display: flex; gap: 12px; align-items: flex-start; }

@keyframes toss {
  0%   { transform: translateY(-16px) rotate(-8deg); opacity: .7; }
  60%  { transform: translateY(0) rotate(0deg);      opacity: 1; }
  100% { transform: translateY(0) rotate(0deg);      opacity: 1; }
}
.die.toss { animation: toss .45s ease-out; }


.dice-area {
  position: relative;
  width: 320px;   /* tune */
  height: 220px;  /* tune */
}
/* transparent panel to match your sheet */
.panel--ghost {
  background: transparent;
  border: none;
  box-shadow: none;
  padding: 0;
}

/* the dice “stage” */
.dice-area {
  position: relative;
  width: 320px;   /* tune for desktop */
  height: 200px;  /* tune for desktop */
  margin: 8px 0 0;
}

/* space where dice can land (keeps clear of the button area) */
.scatter-surface {
  position: absolute;
  left: 8px; right: 8px;
  top: 8px; bottom: 56px; /* reserve space for the button */
  pointer-events: none;   /* clicks pass through */
}

/* keep the roll button anchored */
.dice-area .roll-btn {
  position: absolute;
  left: 50%;
  bottom: 8px;
  transform: translateX(-50%);
  z-index: 2;
}

/* total in top-right of the dice area */
.dice-total {
  position: absolute;
  top: 8px;
  right: 12px;
  font-size: 16px;
  z-index: 2;
}

/* mobile tuning */
@media (max-width: 640px) {
  .dice-area { width: 260px; height: 180px; }
  .scatter-surface { left: 6px; right: 6px; top: 6px; bottom: 52px; }
}
.consequence-box {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 8px;
  border: 2px solid #111;
  border-radius: 6px;
  background: #fff;         /* overridden per-box via inline style */
}

.consequence-label {
  font-weight: 800;
  letter-spacing: 0.2px;
  white-space: nowrap;
}

.consequence-input {
  flex: 1;
  border: none;
  outline: none;
  background: transparent;
  font: inherit;
  padding: 2px 0;
}

.consequence-color {
  width: 26px;
  height: 26px;
  border: none;
  background: transparent;
  padding: 0;
  cursor: pointer;
}

/* (Optional) make them a bit tighter on phones */
@media (max-width: 640px) {
  .consequence-box { padding: 4px 6px; border-width: 1.5px; }
  .consequence-color { width: 22px; height: 22px; }
}
.consequence-box {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 2px 4px;
  border-radius: 4px;
}

.consequence-label {
  font-weight: 600;
  margin-right: 4px;
}


@media (max-width: 640px) {
  .consequence-box {
    padding: 1px 2px;       /* tighter padding */
    gap: 4px;               /* reduce spacing */
  }

  .consequence-label {
    font-size: 10px;        /* smaller subtitle */
  }

  .consequence-input {
    font-size: 10px;
    padding: 1px 2px;
  }
}
/* ONLY touch the Āpitihanga (extras) column */
.extras-column .extra-row {
  height: 43px;               /* force consistent row height */
  display: flex;
  align-items: center;
}

.extras-column .extra-row .skill-extra {
  height: 100%;
  line-height: 26px;
  font-size: 14px;
  padding: 0 6px;
  box-sizing: border-box;
}
/* Optional: adjust on mobile separately */
@media (max-width: 640px) {
  .extras-column .extra-row { height: 14.7px; }
  .extras-column .extra-row .skill-extra {
    line-height: 24px;
    font-size: 10px;
    padding: 8px;
  }
}
/* Locked inherited ahei display */



.ahei-empty {
  font-size: 12px;
  opacity: 0.75;
  padding: 4px 0;
}

.ahei-view .ahei-title {
  font-weight: 800;
  margin-bottom: 4px;
  letter-spacing: 0.2px;
}

/* NEW */
.ahei-desc { font-size: 13px; line-height: 1.25; }
@media (max-width: 640px) { .ahei-desc { font-size: 10px; } }


/* Mobile toggle for the inherited Āhei description */
.toggle-desc {
  margin-top: 4px;
  padding: 4px 6px;
  font-size: 12px;
  border: 1px solid #ccc;
  border-radius: 4px;
  background: #fff;
  cursor: pointer;
}



/* The description is visible whenever the box is rendered */
.ahei-locked .ahei-desc { display: block; }


/* Phones (<=640px): hide desc by default, show when .open. Show the button. */
@media (max-width: 640px) {
  .ahei-locked .ahei-desc { display: none; }
  .ahei-locked.open .ahei-desc { display: block; }
  .toggle-desc { display: inline-block; }
}



/* --- Force the mobile toggle to show and be clickable --- */
@media (max-width: 640px) {
  .btn.toggle-desc {
    display: inline-block !important;
    position: relative;
    z-index: 1000;
    outline: 1px dashed transparent; /* change to 'red' to debug visually */
  }
  /* hide description by default on phones, show when .open */
  .ahei-locked .ahei-desc { display: none !important; }
  .ahei-locked.open .ahei-desc { display: block !important; }
}


.btn.toggle-desc { outline: 1px dashed red !important; }

/* On phones: start collapsed; show content only when open */
@media (max-width: 640px) {
  /* Neutralize old rules that used .open class */
  .ahei-locked .ahei-desc { display: none !important; }
   .ahei-desc { display: block !important; }
}


  


/* Optional: chevron + rotate on open */
.ahei-locked > ::before {
  content: "▸";
  display: inline-block;
  margin-right: 6px;
  transition: transform .15s ease;
}
.ahei-locked[open] > :before {
  transform: rotate(90deg);
}

/* If you want the button aligned right */
.ahei-locked { text-align: left; }

/* MOBILE: make the details panel overlay other fields when open */

  
  

/* Compact "Show details" control */

.btn.toggle-desc {
  display: inline-flex;
  align-items: center;
  padding: 1px 6px;     /* ↓ shrink vertical/horizontal padding */
  line-height: 1;       /* ↓ prevents tall line box */
  font-size: 10px;      /* tweak to taste */
  border-radius: 4px;
  min-height: 0;        /* cancel any UA min height */
}

/* Even tighter on phones */
@media (max-width: 640px) {
  
  .btn.toggle-desc {
    padding: 1px 5px;
    font-size: 11px;
  }
}

/* If you're using <summary>, hide the default marker */
:-webkit-details-marker { display: none; }
:marker { content: ""; }
/* Desktop (>=641px) */


/* Desktop only */
@media (min-width: 641px) {
  .ahei-locked { 
    width: 120%;          /* or a fixed/max width just for desktop */
    max-width: none;      /* e.g., max-width: 560px; if you want a cap */
    margin-inline: 0;     /* undo any centering from mobile */
  }
  .ahei-locked.open {     /* if you use overlay style while open */
    width: 100%;
    max-width: none;
  }
}

/* Mobile only (your narrower setting) */
@media (max-width: 640px) {
  .ahei-locked,
  .ahei-locked.open {
    width: 80%;
    margin-inline: auto;  /* center on mobile */
  }
}
/* Put this near the END of your CSS file */
.ahei-locked,
.ahei-locked.open {
  background-color: #fff;   /* solid white, no alpha */
}
.ahei-locked,
.ahei-locked.open {
  background: #fff !important;   /* solid */
}
/* 1) Make the open/toggled description box SOLID and elevated */
.ahei-locked.open {
  background: #fff !important;          /* solid white */
  box-shadow: 0 8px 24px rgba(0,0,0,.25) !important;
}


/* 3) Prevent parent clipping and provide a positioning context */
.sheet-wrap,
.sheet {
  position: relative;                    /* establish positioning context */
  overflow: visible;                     /* allow overlay to spill over */
}





/* Container shouldn’t clip overlays */
.sheet-wrap,
.sheet {
  position: relative;
  overflow: visible;
}
.ahei-locked { background: #fff; }


@media (max-width: 640px) {
  .ahei-locked:not(.open) { display: none; }/* collapse desc on mobile when closed */
}
.sheet { position: relative; z-index: 0; }
.field { position: absolute; }
/* Base stacking context */
.sheet { position: relative; z-index: 0; }

/* All positioned fields live under titles/overlays by default */
.field { position: absolute; z-index: 1; }

/* Titles a touch higher if needed */
.title { z-index: 3; }

/* Toggle button wrapper LOWER than most things */
.field--toggle { z-index: 2; }

/* Dice / other panels (if you want them above normal fields) */
.panel, .dice-panel { z-index: 8; }

/* === AHEI TOGGLES & OVERLAYS — CANONICAL === */

/* Base stacking */
.sheet { position: relative; z-index: 0; }
.field { position: absolute; z-index: 1; }
.title { z-index: 3; }        /* titles above normal fields */
.panel, .dice-panel { z-index: 8; }  /* dice panel, etc. */

/* Toggle button (always visible on all breakpoints) */
.btn.toggle-desc {
  display: inline-flex;
  align-items: center;
  gap: .35rem;
  padding: 2px 6px;
  font-size: 12px;
  border: 1px solid #ccc;
  border-radius: 4px;
  background: #fff;
  cursor: pointer;
  position: relative;   /* default stacking */
  z-index: auto;        /* default stacking */
}

/* Optional: wrapper for toggle position fields */
.field--toggle { z-index: 2; }

/* Overlays: hidden by default; shown when JS adds .open */
.field.overlay-wrap { position: absolute; display: none; }
.field.overlay-wrap.open { display: block; }

/* Give each overlay its own z-plane so they never clash */
.field.overlay-wrap--inherited { z-index: 15; } /* Mana Tuku Iho */
.field.overlay-wrap--origin    { z-index: 14; } /* Mana a Rohe */

/* The actual description box */
.overlay-box {
  background: #fff;                 /* solid, no transparency */
  border: 2px solid #111;
  border-radius: 8px;
  box-shadow: 0 6px 16px rgba(0,0,0,.25);
  padding: 10px 12px;
  max-height: 220px;
  overflow: auto;
}

/* Keep the inline “locked” box (if you still use it elsewhere) solid too */
.ahei-locked {
  border: 2px solid #111;
  border-radius: 6px;
  background: #fff;                 /* solid background */
  padding: 8px 10px;
}

/* Text inside both overlays */
.ahei-desc { font-size: 13px; line-height: 1.25; }
@media (max-width: 640px) { .ahei-desc { font-size: 10px; } }

/* === FORCE TOGGLES TO SHOW ON DESKTOP & MOBILE === */
.btn.toggle-desc {
  display: inline-flex !important;   /* beat earlier display:none rules */
  position: relative;
  z-index: 2;                        /* below overlays (which are 13/14/15) */
}

/* Keep overlays above the buttons when opened */
.overlay-wrap--inherited { z-index: 14; }
.overlay-wrap--origin    { z-index: 13; }   /* or 15 if you want it on top */


@media (max-width: 640px) {
  .extras-column .extra-row { height: 18px; }  /* slimmer than 24px */
  .skill-extra {
    width: 18px;          /* small but still tappable */
    font-size: 10px;      /* matches rest of mobile text scale */
    padding: 2px;         /* less inner space */
  }
}
/* === Mobile row-height sync (keep widths) === */
@media (max-width: 640px) {
  :root {
    --rowH-mobile: 16px;   /* tweak 14–18px to taste */
    --rowFont-mobile: 9px; /* keep text crisp but small */
  }

  /* Skills dropdowns (left column) */
  .skills-column .skill-row { margin-bottom: 4.5px; }
  .skills-column .skill-row select {
    height: var(--rowH-mobile) !important;
    line-height: var(--rowH-mobile) !important;
    padding: 0 2px !important;
    font-size: var(--rowFont-mobile) !important;
  }

  /* Base value box beside each select */
  .skill-base {
    height: var(--rowH-mobile) !important;
    line-height: var(--rowH-mobile) !important;
    padding: 0 2px !important;
    font-size: var(--rowFont-mobile) !important;
  }

  /* Extras column (right) — match the same row height */
  .extras-column .extra-row {
    height: var(--rowH-mobile) !important;
  }
  .extras-column .extra-row .skill-extra {
    height: 100% !important;
    line-height: var(--rowH-mobile) !important;
    width: 16px !important;           /* stays narrow */
    font-size: var(--rowFont-mobile) !important;
    padding: 0 2px !important;
  }
}
/* Default (desktop ≥ 641px): top-right inside the scatter box */
.dice-total {
  position: absolute;
  top: 8px;
  right: 8px;
  font-size: 20px;
  font-weight: 700;
  padding: 6px 8px;
  background: rgba(109, 233, 255, 0.75);
  border-radius: 4px;
  z-index: 2;          /* stays above dice */
}
/* Mobile (≤ 640px): bottom-center inside the scatter box */
@media (max-width: 640px) {
  .dice-total {
    top: auto;
    right: auto;
    bottom: 6px;
    left: 100%;
    transform: translateX(-50%);
    font-size: 16px;
    padding: 4px 6px;
  }
}
.dice-total {
  text-align: center;
  margin-top: 8px;         /* space above Roll button */
  font-size: 20px;
  font-weight: 700;
  background: rgba(109, 233, 255, 0.75);
  border-radius: 4px;
  padding: 6px 8px;
}

/* Mobile override */
@media (max-width: 640px) {
  .dice-total {
    font-size: 16px;
    padding: 4px 6px;
    margin-top: 6px;      /* a bit tighter on phones */
  }
}

/* Weapon popup overlay */
.overlay-wrap--weapon { z-index: 28; }

.overlay-box--weapon {
  background: #fff;
  border: 2px solid #111;
  border-radius: 8px;
  box-shadow: 0 6px 16px rgba(0,0,0,.25);
  padding: 10px 12px;
  max-height: 240px;
  overflow: auto;
}
.field.overlay-wrap { position: absolute; display: none; }
.field.overlay-wrap.open { display: block; }

/* --- Weapon popup: subtle slide-in --- */
.overlay-wrap--weapon.open .overlay-box--weapon {
  animation: weaponSlideIn 180ms cubic-bezier(.2,.7,.2,1) both;
  will-change: transform, opacity;
}

/* Desktop: slide in from the right (toward the image), a little lift */
@keyframes weaponSlideIn {
  from {
    transform: translateX(12px) translateY(0) scale(0.995);
    opacity: 0;
  }
  to {
    transform: translateX(0) translateY(0) scale(1);
    opacity: 1;
  }
}

/* Mobile: slightly shorter distance so it feels snappy on small screens */
@media (max-width: 640px) {
  .overlay-wrap--weapon.open .overlay-box--weapon {
    animation-duration: 140ms;
  }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .overlay-wrap--weapon.open .overlay-box--weapon {
    animation: none;
  }
}

/* Ultimate overlays — look/feel like other ability popups */
.field.overlay-wrap--ult { display: none; position: absolute; }
.field.overlay-wrap--ult.open { display: block; }

.overlay-box--ult {
  background: #fff;
  border: 2px solid #111;
  border-radius: 8px;
  box-shadow: 0 6px 16px rgba(0,0,0,.25);
  padding: 10px 12px;
  max-height: 220px;
  overflow: auto;
}

/* Make sure these float above the toggle button */
.field.overlay-wrap--ult { z-index: 22; }

/* Optional: subtle slide like your weapon popup */
.overlay-wrap--ult.open .overlay-box--ult {
  animation: ultSlideIn 160ms cubic-bezier(.2,.7,.2,1) both;
}
@keyframes ultSlideIn {
  from { transform: translateY(-6px); opacity: 0; }
  to   { transform: translateY(0);    opacity: 1; }
}

@media (prefers-reduced-motion: reduce) {
  .overlay-wrap--ult.open .overlay-box--ult { animation: none; }
}

/* Make disabled selects look like normal āhei dropdowns */
.select-underline:disabled {
  opacity: 1;
  color: #000;
  -webkit-text-fill-color: #000; /* Safari */
  background: rgba(255, 255, 255, 0.5);
  cursor: default;
}

/* Make disabled selects look like normal āhei dropdowns */
.select-underline:disabled {
  opacity: 1;
  color: #000;
  -webkit-text-fill-color: #000; /* Safari */
  background: rgba(255, 255, 255, 0.5);
  cursor: default;
}
.select-underline:disabled {
  border-bottom-color: #000; /* match enabled state */
}
/* Match your enabled select’s padding exactly */
.select-underline {
  padding: 2px 2px 3px 2px;
}
.select-underline:disabled {
  padding: 2px 2px 3px 2px;
}
/* consistent text sizing on iOS */
html { -webkit-text-size-adjust: 100%; }

/* prevent iOS zoom jump on tap for inputs/selects */
@supports (-webkit-touch-callout: none) {
  input, select, textarea, button {
    font-size: 16px; /* iOS won't zoom if >=16px */
  }
}
/* flatten Safari-specific control chrome */
input, select, textarea, button {
  -webkit-appearance: none;
  appearance: none;
  border-radius: 4px; /* keep your rounded look */
}

/* keep disabled selects visually identical */
.select-underline:disabled {
  -webkit-text-fill-color: #000;
}
/* global font rendering smoothing */
html, body {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* headings/labels: nail line-height so wrapping doesn't surprise you */
.field-label,
.mini-label,
.ult-label,
.ahei-desc {
  line-height: 1.2; /* or 1.15 – pick one and keep it consistent */
  letter-spacing: 0; /* Safari sometimes renders spacing slightly wider */
}
/* ensure overlays are really solid layers */
.overlay-box,
.overlay-box--weapon,
.overlay-box--ult {
  background: #fff !important;
}
.sheet { position: relative; }         /* the reference */
.field { position: absolute; }         /* children place via left/top % */
/* contain content to the visual viewport */
@supports (-webkit-touch-callout: none) {
  body { overflow-x: hidden; }
}
input, select, textarea {
  box-shadow: none;
  border: none;               /* you draw your own underline */
  background-clip: padding-box;
}
.skill-extra[disabled] {
  background: #f4fbff;
  border: 1px solid #cfe9ff;
  color: #111;
  opacity: 1; /* keep it readable */
  cursor: default;
}
